<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparador de Archivos Excel</title>

    <!-- Librer√≠a XLSX para leer/escribir Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Estilos separados -->
    <link rel="stylesheet" href="comparador.css">
</head>
<body>

<div class="container">

    <h1>üìä Comparador de Archivos Excel</h1>
    <p class="subtitle">Sube dos archivos y compara columnas de ambos ‚Äî soporta archivos grandes</p>

    <!-- =====================
         CARGA DE ARCHIVOS
         ===================== -->
    <div class="upload-section">
        <div>
            <div class="upload-area" id="uploadArea1">
                <div class="upload-icon">üìÅ</div>
                <h3>Archivo 1</h3>
                <p style="margin-bottom:10px; color:#333; font-weight:600;">Arrastra aqu√≠ o haz clic</p>
                <p style="color:#666; font-size:14px;">Formatos: .xlsx, .xls, .csv</p>
                <input type="file" id="fileInput1" accept=".xlsx,.xls,.csv">
                <button class="btn" onclick="document.getElementById('fileInput1').click()">Seleccionar</button>
                <div class="file-name" id="fileName1"></div>
            </div>
        </div>
        <div>
            <div class="upload-area" id="uploadArea2">
                <div class="upload-icon">üìÅ</div>
                <h3>Archivo 2</h3>
                <p style="margin-bottom:10px; color:#333; font-weight:600;">Arrastra aqu√≠ o haz clic</p>
                <p style="color:#666; font-size:14px;">Formatos: .xlsx, .xls, .csv</p>
                <input type="file" id="fileInput2" accept=".xlsx,.xls,.csv">
                <button class="btn" onclick="document.getElementById('fileInput2').click()">Seleccionar</button>
                <div class="file-name" id="fileName2"></div>
            </div>
        </div>
    </div>

    <!-- =====================
         BARRA DE PROGRESO
         Visible mientras se lee / compara
         ===================== -->
    <div class="progress-container" id="progressContainer">
        <div class="progress-title">‚è≥ Procesando...</div>
        <div class="progress-bar-wrap">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-status" id="progressStatus"></div>
    </div>

    <!-- =====================
         SELECTOR DE COLUMNAS
         ===================== -->
    <div id="columnSelector" class="column-selector-section">
        <div class="selector-title">Selecciona las columnas a comparar</div>
        <div class="column-grid">
            <div class="file-columns">
                <h4>Columnas del Archivo 1</h4>
                <div class="checkbox-group" id="columns1"></div>
            </div>
            <div class="file-columns">
                <h4>Columnas del Archivo 2</h4>
                <div class="checkbox-group" id="columns2"></div>
            </div>
        </div>
        <div class="action-buttons">
            <button class="btn" onclick="compareFiles()">Comparar Archivos</button>
            <button class="btn btn-danger" onclick="resetFiles()">Cambiar Archivos</button>
        </div>
    </div>

    <!-- =====================
         RESULTADOS
         ===================== -->
    <div id="results" class="results">
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalMatches">0</div>
                <div class="stat-label">Coincidencias √∫nicas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalDifferences">0</div>
                <div class="stat-label">Diferencias √∫nicas</div>
            </div>
        </div>

        <h2>üìã Resultados de Comparaci√≥n</h2>
        <div class="comparison-list" id="comparisonList"></div>

        <div class="action-buttons" style="margin-top:30px;">
            <button class="btn btn-secondary" onclick="downloadResults()">üì• Descargar Resultados (Excel completo)</button>
            <button class="btn btn-danger" onclick="resetFiles()">Analizar Otros Archivos</button>
        </div>
    </div>

    <!-- Bot√≥n men√∫ principal -->
    <div class="botones-control">
        <button class="btn-secundario" onclick="solicitarContrase√±a()">
            <span>üè†</span><span>Men√∫ Principal</span>
        </button>
    </div>

</div><!-- /container -->

<!-- =====================
     MODAL CONTRASE√ëA
     ===================== -->
<div class="modal-overlay" id="modalContrase√±a">
    <div class="modal-content">
        <h2>üîê Acceso Restringido</h2>
        <p>Ingresa la contrase√±a para regresar al men√∫ principal</p>
        <div class="error-modal" id="errorMsg" style="display:none;"></div>
        <input
            type="password"
            id="inputContrase√±a"
            class="password-input"
            placeholder="Contrase√±a"
            onkeypress="if(event.key==='Enter') verificarContrase√±a()"
        >
        <div class="modal-buttons">
            <button class="btn-confirmar" onclick="verificarContrase√±a()">Confirmar</button>
            <button class="btn-cancelar"  onclick="cancelarAcceso()">Cancelar</button>
        </div>
    </div>
</div>

<!-- Script separado -->
<script src="comparador.js"></script>

</body>
</html>